<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>AddAccountController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">MavenATMv2</a> &gt; <a href="index.source.html" class="el_package">controller</a> &gt; <span class="el_source">AddAccountController.java</span></div><h1>AddAccountController.java</h1><pre class="source lang-java linenums">package controller;

import static model.Constants.*;


import model.Account;
import model.AddAccount;
import model.Transaction;
import model.UnBlockAccount;
import view.Keypad;
import view.Screen;

public class AddAccountController extends TransactionController{
<span class="nc" id="L14">	private Account accAdded = new Account();</span>
	private int statusAdd; //status transaction process
	
	public AddAccountController(Transaction theTransaction, Keypad theKeypad, Screen theScreen) {
<span class="nc" id="L18">		super(theTransaction, theKeypad, theScreen);</span>
		// TODO Auto-generated constructor stub
<span class="nc" id="L20">	}</span>

	@Override
	public void run() {
		// TODO Auto-generated method stub
<span class="nc" id="L25">		AddAccount transaction = (AddAccount) getTransaction();</span>
<span class="nc" id="L26">		Screen screen = getScreen(); // get screen reference</span>
		int statusProcess;
		 // loop while no valid choice has been made on unblock account option menu
		do {
<span class="nc" id="L30">			displayMenuOfAccounts();</span>
<span class="nc bnc" id="L31" title="All 2 branches missed.">			 while (statusAdd &lt;= 0) {</span>
<span class="nc bnc" id="L32" title="All 10 branches missed.">				 switch(statusAdd) {</span>
				 	case ADD_ACCOUNT_ERROR_INPUT_DIGIT_ACC:
<span class="nc" id="L34">				 		screen.displayMessageLine(&quot;The number of digit account number must be equal 4 digits&quot;);</span>
<span class="nc" id="L35">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_POSITIVE_VALUE_ACC:
<span class="nc" id="L37">				 		screen.displayMessageLine(&quot;Value account number not valid, must be positif value&quot;);</span>
<span class="nc" id="L38">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_INPUT_DIGIT_PIN:
<span class="nc" id="L40">				 		screen.displayMessageLine(&quot;The number of digit pin must be equal 4 digits&quot;);</span>
<span class="nc" id="L41">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_POSITIVE_VALUE_PIN:
<span class="nc" id="L43">				 		screen.displayMessageLine(&quot;Value pin not valid, must be positif value&quot;);</span>
<span class="nc" id="L44">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_POSITIVE_VALUE_AVBALANCE:
<span class="nc" id="L46">				 		screen.displayMessageLine(&quot;Value available balance not valid, must be positif value&quot;);</span>
<span class="nc" id="L47">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_INPUT_RANGE_AVBALANCE:
<span class="nc" id="L49">				 		screen.displayMessageLine(&quot;Your balance does not meet the minimum balance standar&quot;);</span>
<span class="nc" id="L50">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_POSITIVE_VALUE_DEPOSIT:
<span class="nc" id="L52">				 		screen.displayMessageLine(&quot;Value deposit fund not valid, must be positif value&quot;);</span>
<span class="nc" id="L53">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_INPUT_RANGE_DEPOSIT:
<span class="nc" id="L55">				 		screen.displayMessageLine(&quot;Your deposit fund does not meet the minimum deposito standar&quot;);</span>
<span class="nc" id="L56">				 		break;</span>
				 	case ADD_ACCOUNT_ERROR_INPUT_MENU :
<span class="nc" id="L58">						screen.displayMessageLine(&quot;Invalid selection. Try again!&quot;);</span>
						break;
				 }
<span class="nc" id="L61">				 displayMenuOfAccounts();</span>
			 }
			 
<span class="nc" id="L64">			 transaction.setNewAccount(accAdded);</span>
<span class="nc" id="L65">			 transaction.setStatusAdd(statusAdd);</span>
<span class="nc" id="L66">			 statusProcess = transaction.execute();</span>
<span class="nc bnc" id="L67" title="All 4 branches missed.">			 switch (statusProcess) {</span>
				case ACCOUNT_REGISTERED:
<span class="nc" id="L69">					screen.displayMessageLine(&quot;Account number has been registered in systemï¿½&quot;);</span>
<span class="nc" id="L70">					break;</span>
				case ADD_ACCOUNT_CANCELED :
<span class="nc" id="L72">					screen.displayMessageLine(&quot;You canceled transaction&quot;);</span>
<span class="nc" id="L73">					break;</span>
				case ADD_ACCOUNT_SUCCESSFUL :
<span class="nc" id="L75">					screen.displayMessageLine(&quot;Account number has been been add&quot;);</span>
					break;	
			}
<span class="nc bnc" id="L78" title="All 2 branches missed.">			}while(statusProcess!=ADD_ACCOUNT_CANCELED);				</span>
<span class="nc" id="L79">	}</span>

	private void displayMenuOfAccounts() {
		// TODO Auto-generated method stub
		Account inputSheet;
		int inputAccNum, inputPinNum;
		double inputAvBalance, inputDeposito;
		String inputDesc;
		
		 // display the add cash menu
<span class="nc" id="L89">		screen.displayMessageLine(&quot;\nAdd Account Menu:&quot;);</span>
<span class="nc" id="L90">		screen.displayMessageLine(&quot;1 - Add Account Nasabah&quot;);</span>
<span class="nc" id="L91">		screen.displayMessageLine(&quot;2 - Add Account Admin&quot;);</span>
<span class="nc" id="L92">		screen.displayMessageLine(&quot;3 - Cancel Transaction&quot;);</span>
<span class="nc" id="L93">		screen.displayMessage(&quot;\nChoose option menu: &quot;);</span>
		
<span class="nc" id="L95">		 int input = keypad.getInput(); // get user input through keypad</span>
		 // determine how to proceed based on the input value
<span class="nc bnc" id="L97" title="All 3 branches missed.">		 switch (input) {</span>
		 	case 1: // do add account number nasabah process
		 	case 2: // do add account number admin process	
<span class="nc" id="L100">		 		screen.displayMessage(&quot;Input account number:&quot;);		 		</span>
<span class="nc" id="L101">		 		inputAccNum = keypad.getInput(); // input acc number</span>
				
				// validation input account number
<span class="nc" id="L104">				statusAdd = inputAccountNumberValidation(inputAccNum);</span>
<span class="nc bnc" id="L105" title="All 2 branches missed.">				if (statusAdd == VALIDATION_ADD_SUCCESSFULL) {</span>
<span class="nc" id="L106">					screen.displayMessage(&quot;Input pin number:&quot;);		 		</span>
<span class="nc" id="L107">					inputPinNum = keypad.getInput(); // input pin number</span>
					
					// validation pin number
<span class="nc" id="L110">					statusAdd = pinNumberValidation(inputPinNum);</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">					if (statusAdd == VALIDATION_ADD_SUCCESSFULL) {</span>
<span class="nc bnc" id="L112" title="All 2 branches missed.">						if(input==1) { // for add account nasabah process</span>
<span class="nc" id="L113">							screen.displayMessage(&quot;Input available balance:&quot;);		 		</span>
<span class="nc" id="L114">							inputAvBalance = keypad.getInput(); // input available balance</span>
							
							// validation available balance
<span class="nc" id="L117">							statusAdd = availableBalanceValidation(inputAvBalance);</span>
<span class="nc bnc" id="L118" title="All 2 branches missed.">							if (statusAdd == VALIDATION_ADD_SUCCESSFULL) {</span>
<span class="nc" id="L119">								screen.displayMessage(&quot;Input deposit fund:&quot;);		 		</span>
<span class="nc" id="L120">								inputDeposito = keypad.getInput(); // input deposito</span>
								
								// validation deposit fund
<span class="nc" id="L123">								statusAdd = depositFundValidation(inputDeposito);</span>
<span class="nc bnc" id="L124" title="All 2 branches missed.">								if (statusAdd == VALIDATION_ADD_SUCCESSFULL) {</span>
<span class="nc" id="L125">									screen.displayMessage(&quot;Input description Account:&quot;);		 		</span>
<span class="nc" id="L126">									inputDesc = keypad.getInputString(); // input deskripsi account</span>
<span class="nc" id="L127">									inputSheet = new Account(inputAccNum, inputPinNum, inputAvBalance, inputDeposito, </span>
											inputDesc, ROLE_INDIVIDUAL_CUSTOMER, STATUS_ACC_ACTIVE);
<span class="nc" id="L129">									accAdded = inputSheet;</span>
								}
							}
						}else { // for add account admin
<span class="nc" id="L133">							screen.displayMessage(&quot;Input description Account:&quot;);		 		</span>
<span class="nc" id="L134">							inputDesc = keypad.getInputString(); // input deskripsi account</span>
							// available balance dan deposito diisi dengan nol
<span class="nc" id="L136">							inputSheet = new Account(inputAccNum, inputPinNum, 0, 0, inputDesc, ROLE_ADMIN, STATUS_ACC_ACTIVE);</span>
<span class="nc" id="L137">							accAdded = inputSheet;</span>
						}						
					}
				}
				
		 		break;       
		 	case ADD_ACCOUNT_CANCELED: // the user chose to cancel
<span class="nc" id="L144">		 		statusAdd = ADD_ACCOUNT_CANCELED; // save user's choice</span>
<span class="nc" id="L145">		 		break;</span>
		 	default: // the user did not enter a value from 1-2
<span class="nc" id="L147">		 		statusAdd = ADD_ACCOUNT_ERROR_INPUT_MENU;</span>
			} 
<span class="nc" id="L149">	 }</span>

	private int inputAccountNumberValidation(int inputAccNum) {
		int statusInput;
		
<span class="nc bnc" id="L154" title="All 2 branches missed.">		if (!isValidValueNumberFourDigit(inputAccNum)) { // cek jumlah digit account number apakah 4? (V1)</span>
<span class="nc" id="L155">			statusInput = ADD_ACCOUNT_ERROR_INPUT_DIGIT_ACC;</span>
<span class="nc bnc" id="L156" title="All 2 branches missed.">		}else if (!isValidAccountNumberValue(inputAccNum)) { // cek account number bernilai positif (V2)</span>
<span class="nc" id="L157">			statusInput = ADD_ACCOUNT_ERROR_POSITIVE_VALUE_ACC;</span>
		}else {
<span class="nc" id="L159">			statusInput = VALIDATION_ADD_SUCCESSFULL;</span>
		}
		
<span class="nc" id="L162">		return statusInput;</span>
	}
	
	private int pinNumberValidation(int inputPin) {
		// TODO Auto-generated method stub
		int statusInput;
		
<span class="nc bnc" id="L169" title="All 2 branches missed.">		if (!isValidValueNumberFourDigit(inputPin)) { // cek jumlah digit pin number apakah 4? (V4)</span>
<span class="nc" id="L170">			statusInput = ADD_ACCOUNT_ERROR_INPUT_DIGIT_PIN; </span>
<span class="nc bnc" id="L171" title="All 2 branches missed.">		}else if (!isValidAccountNumberValue(inputPin)) { // cek pin number bernilai positif (V5)</span>
<span class="nc" id="L172">			statusInput = ADD_ACCOUNT_ERROR_POSITIVE_VALUE_PIN;</span>
		}else {
<span class="nc" id="L174">			statusInput = VALIDATION_ADD_SUCCESSFULL;</span>
		}
<span class="nc" id="L176">		return statusInput;</span>
	}
	 
	private int availableBalanceValidation(double inputAvailableBalance) {
		// TODO Auto-generated method stub
		int statusInput;
<span class="nc bnc" id="L182" title="All 2 branches missed.">		if (!isValidInputAmmount(inputAvailableBalance)) { // cek available balance bernilai positif (V6)</span>
<span class="nc" id="L183">			statusInput = ADD_ACCOUNT_ERROR_POSITIVE_VALUE_AVBALANCE;</span>
<span class="nc bnc" id="L184" title="All 2 branches missed.">		}else if(!isValidInputRangeBalance(inputAvailableBalance)){ // cek available balance dengan syarat minimal saldo $100 (V7)</span>
<span class="nc" id="L185">			statusInput = ADD_ACCOUNT_ERROR_INPUT_RANGE_AVBALANCE;</span>
		}else {
<span class="nc" id="L187">			statusInput = VALIDATION_ADD_SUCCESSFULL;</span>
		}		
		
<span class="nc" id="L190">		return statusInput;</span>
	}

	private int depositFundValidation(double inputDepositFund) {
		// TODO Auto-generated method stub
		int statusInput;
<span class="nc bnc" id="L196" title="All 2 branches missed.">		if (!isValidInputAmmount(inputDepositFund)) { // cek deposit fund bernilai positif (V8)</span>
<span class="nc" id="L197">			statusInput = ADD_ACCOUNT_ERROR_POSITIVE_VALUE_DEPOSIT;</span>
<span class="nc bnc" id="L198" title="All 2 branches missed.">		}else if(!isValidInputRangeDeposit(inputDepositFund)){ // cek deposit fund e dengan syarat minimal saldo $500 (V9)</span>
<span class="nc" id="L199">			statusInput = ADD_ACCOUNT_ERROR_INPUT_RANGE_DEPOSIT;</span>
		}else {
<span class="nc" id="L201">			statusInput = VALIDATION_ADD_SUCCESSFULL;</span>
		}		
<span class="nc" id="L203">		return statusInput;</span>
	}
	
	private boolean isValidAccountNumberValue(int AccountNumber) {
<span class="nc bnc" id="L207" title="All 2 branches missed.">		 if(AccountNumber &gt; 0) {</span>
<span class="nc" id="L208">			 return  true;</span>
		 }else {
<span class="nc" id="L210">			 return false;</span>
		 }
	}
	 
	 private boolean isValidValueNumberFourDigit(int Number) {
<span class="nc" id="L215">		 int digitValue = 0;</span>
<span class="nc" id="L216">		 Number = Math.abs(Number);</span>
<span class="nc bnc" id="L217" title="All 2 branches missed.">		 while (Number&gt;0) {</span>
<span class="nc" id="L218">			 Number = Number / 10;</span>
<span class="nc" id="L219">			 digitValue = digitValue + 1;</span>
		 }
<span class="nc bnc" id="L221" title="All 2 branches missed.">		 if(digitValue == 4) {</span>
<span class="nc" id="L222">			 return  true;</span>
		 }else {
<span class="nc" id="L224">			 return false;</span>
		 }
	}
	
	private boolean isValidInputAmmount(double amount) {
			// TODO Auto-generated method stub
<span class="nc bnc" id="L230" title="All 2 branches missed.">		if(amount&gt;0) {</span>
<span class="nc" id="L231">			return  true;</span>
		}else {
<span class="nc" id="L233">			return false;</span>
		}
	}
	
	private boolean isValidInputRangeBalance(double amount) {
		// TODO Auto-generated method stub
<span class="nc bnc" id="L239" title="All 2 branches missed.">		if(amount&gt;=100) {</span>
<span class="nc" id="L240">			return  true;</span>
		}else {
<span class="nc" id="L242">			return false;</span>
		}
	}
	
	private boolean isValidInputRangeDeposit(double amount) {
		// TODO Auto-generated method stub
<span class="nc bnc" id="L248" title="All 2 branches missed.">		if(amount&gt;=500) {</span>
<span class="nc" id="L249">			return  true;</span>
		}else {
<span class="nc" id="L251">			return false;</span>
		}
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.6.202009150832</span></div></body></html>